# NAGIOS CONFIG SNIPPETS FOR APACHE WEB SERVER
#
# Do not edit this file manually, it is managed by
# Ansible and will be overwriten during next run.

ScriptAlias /nagios/cgi-bin "/usr/local/nagios/sbin"

<Directory "/usr/local/nagios/sbin">
  SSLRequireSSL
  Options ExecCGI
  AllowOverride None
  Order allow,deny
  Allow from all

  AuthName "Nagios Access"
  AuthType Basic
  AuthBasicProvider ldap

  AuthName "Nagios Access"
  AuthType Basic
  AuthBasicProvider ldap

  AuthLDAPURL "{{ ldap_auth_url }}"
  AuthLDAPBindDN "{{ ldap_bind_name }}"
  AuthLDAPBindPassword "{{ ldap_password }}"
{% for group in allowed_ldap_groups %}
  Require ldap-group cn={{ group }},{{ ldap_group_base }}
{% endfor %}
</Directory>

Alias /nagios "/usr/local/nagios/share"

<Directory "/usr/local/nagios/share">
  SSLRequireSSL
  Options None
  AllowOverride None
  Order allow,deny
  Allow from all

  AuthName "Nagios Access"
  AuthType Basic
  AuthBasicProvider ldap

  AuthLDAPURL "{{ ldap_auth_url }}"
  AuthLDAPBindDN "{{ ldap_bind_name }}"
  AuthLDAPBindPassword "{{ ldap_password }}"
{% for group in allowed_ldap_groups %}
  Require ldap-group cn={{ group }},{{ ldap_group_base }}
{% endfor %}
</Directory>

RewriteEngine on
RedirectMatch 301 ^/$ /nagios/
